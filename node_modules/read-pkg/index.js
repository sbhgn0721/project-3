'use strict';
<<<<<<< HEAD
const fs = require('fs');
const path = require('path');
const parseJson = require('parse-json');
const pify = require('pify');

const readFileAsync = pify(fs.readFile);

module.exports = options => {
	options = Object.assign({
		cwd: process.cwd(),
		normalize: true
	}, options);

	const filePath = path.resolve(options.cwd, 'package.json');

	return readFileAsync(filePath, 'utf8').then(file => {
		const json = parseJson(file);

		if (options.normalize) {
			require('normalize-package-data')(json);
		}

		return json;
	});
};

module.exports.sync = options => {
	options = Object.assign({
		cwd: process.cwd(),
		normalize: true
	}, options);

	const filePath = path.resolve(options.cwd, 'package.json');
	const json = parseJson(fs.readFileSync(filePath, 'utf8'));

	if (options.normalize) {
		require('normalize-package-data')(json);
	}

	return json;
=======
const path = require('path');
const loadJsonFile = require('load-json-file');
const pathType = require('path-type');

module.exports = (fp, opts) => {
	if (typeof fp !== 'string') {
		opts = fp;
		fp = '.';
	}

	opts = opts || {};

	return pathType.dir(fp)
		.then(isDir => {
			if (isDir) {
				fp = path.join(fp, 'package.json');
			}

			return loadJsonFile(fp);
		})
		.then(x => {
			if (opts.normalize !== false) {
				require('normalize-package-data')(x);
			}

			return x;
		});
};

module.exports.sync = (fp, opts) => {
	if (typeof fp !== 'string') {
		opts = fp;
		fp = '.';
	}

	opts = opts || {};
	fp = pathType.dirSync(fp) ? path.join(fp, 'package.json') : fp;

	const x = loadJsonFile.sync(fp);

	if (opts.normalize !== false) {
		require('normalize-package-data')(x);
	}

	return x;
>>>>>>> master
};
